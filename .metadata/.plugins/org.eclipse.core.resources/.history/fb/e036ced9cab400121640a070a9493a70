/*
 * Regressionstest.cpp
 *
 *  Created on: 24.04.2013
 *      Author: NG
 */

#include "Regressionstest.h"
#include "Addresses.h"
#include "HAL_A/HAL_A.h"
#include "HAL_S/HAL_S.h"
#include <stdlib.h>

#define PRINTBOOL(x) x ? "true" : "false"

using namespace std;
Regressionstest::Regressionstest() {
}

Regressionstest::~Regressionstest() {
}

HAL_A* hal_a = HAL_A::get_instance();
bool erg = false;

void Regressionstest::TestLauf() {
	uint8_t val;
	while (true) {
		val = in8(DIO_BASE + DIO_OFFS_B);

		while ((~val & BIT_0) == BIT_0) {
			hal_a->conveyor_move_right()();
		}

		while ((~val & BIT_1) == BIT_1) {
			sleep(1);
			hal_a->conveyor_move_right()();
		}

		while ((~val & BIT_3) == BIT_3) {
			sleep(1);
			hal_a->bar_open();
			hal_a->conveyor_move_right();
			sleep(3);
			hal_a->bar_close();

		}
		while ((~val & BIT_7) == BIT_7) {
			hal_a->conveyor_stop();
		}
	}
}

